<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="org.sixlab.mr.beans.MovieRecordMapper">

	<select id="selectMovies" parameterType="record" resultMap="Records">
		SELECT
		*
		FROM
		saw
		<where> 
			<if test="id!=null and id!=''">
				id = #{id}
			</if>
			<if test="name!=null and name!=''">
				and name like '%${name}%' 
			</if>
			<if test="country!=null and country!=''">
				and country like '%${country}%' 
			</if>
			<if test="year!=null and year!=''">
				and year like '%${year}%' 
			</if>
			<if test="director!=null and director!=''">
				and director like '%${director}%' 
			</if>
			<if test="actor!=null and actor!=''">
				and actor like '%${actor}%' 
			</if>
			<if test="remark!=null and remark!=''">
				and remark like '%${remark}%' 
			</if>
			<if test="inDate!=null and inDate!=''">
				and inDate like '%${inDate}%' 
			</if>
		</where>
		ORDER BY id DESC
	</select>

	<insert id="insertMovie" parameterType="record" flushCache="true"
		statementType="PREPARED" keyProperty="id"
		useGeneratedKeys="true" >
		INSERT INTO
		saw(name
		<if test="country!=null and country!=''">
			,country
		</if>
		<if test="year!=null and year!=''">
			,year
		</if>
		<if test="director!=null and director!=''">
			,director
		</if>
		<if test="actor!=null and actor!=''">
			,actor
		</if>
		<if test="remark!=null and remark!=''">
			,remark
		</if>
		, inDate)
		VALUES(#{name}
		<if test="country!=null and country!=''">
			,#{country}
		</if>
		<if test="year!=null and year!=''">
			,#{year}
		</if>
		<if test="director!=null and director!=''">
			,#{director}
		</if>
		<if test="actor!=null and actor!=''">
			,#{actor}
		</if>
		<if test="remark!=null and remark!=''">
			,#{remark}
		</if>
		,#{inDate})
	</insert>

	<update id="updateMovie" parameterType="record">
		UPDATE saw
		<set>
			<if test="name!=null and name!=''">
				name=#{name},
			</if>
			<if test="country!=null and country!=''">
				country=#{country},
			</if>
			<if test="year!=null and year!=''">
				year=#{year},
			</if>
			<if test="director!=null and director!=''">
				director=#{director},
			</if>
			<if test="actor!=null and actor!=''">
				actor=#{actor},
			</if>
			<if test="remark!=null and remark!=''">
				remark=#{remark},
			</if>
			<if test="inDate!=null and inDate!=''">
				inDate=#{inDate}
			</if>
		</set>
		WHERE id = #{id}
	</update>

	<resultMap type="record" id="Records">
		<id property="id" column="id"></id>
		<result property="name" column="name"></result>
		<result property="country" column="country"></result>
		<result property="year" column="year"></result>
		<result property="director" column="director"></result>
		<result property="actor" column="actor"></result>
		<result property="remark" column="remark"></result>
		<result property="inDate" column="inDate"></result>
	</resultMap>

	<insert id="insertMovieBackup" parameterType="record"
		flushCache="true" statementType="PREPARED">
		INSERT INTO
		saw(name ,country,year
		,director ,actor ,remark , inDate)
		VALUES(#{name,jdbcType=VARCHAR}
		,#{country,jdbcType=VARCHAR} ,#{year,jdbcType=VARCHAR}
		,#{director,jdbcType=VARCHAR} ,#{actor,jdbcType=VARCHAR}
		,#{remark,jdbcType=VARCHAR} ,#{inDate})
	</insert>

</mapper>